import{s as K,g as X,aO as ee,j as e,aP as te,aQ as ne,aB as B,aR as re,G as F,a9 as ae,aa as se,ab as ie,b as E,d as Z,an as D,e as g,ad as le,ae as oe,a4 as de,f as _,ao as C,ap as T,at as k,ar as m,as as a,r as f,aq as I,w as G,x as H,Q,O as W,U as M,aS as Y,R as O,aT as q,y as ce,ag as V,aU as xe,C as he,aN as ue,n as z}from"./vendor-CY4U35Sj.js";const R=K(X)(({theme:n})=>({backgroundColor:n.palette.grey[100],height:n.spacing(3),color:n.palette.text.primary,fontWeight:n.typography.fontWeightRegular,maxWidth:160,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& .MuiChip-label":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},[n.breakpoints.up("md")]:{maxWidth:"none",whiteSpace:"normal"},cursor:"text","&[data-link='true']":{cursor:"pointer"},"&:hover, &:focus":{backgroundColor:ee(n.palette.grey[100],.06)}}));function me({region:n,province:o,station:l}){return e.jsxs(te,{"aria-label":"breadcrumb",separator:e.jsx(ne,{fontSize:"small"}),sx:{mb:2,flexWrap:{xs:"nowrap",md:"wrap"},overflow:"hidden"},children:[e.jsx(R,{component:B,to:"/awsmap",label:"แผนที่",icon:e.jsx(re,{fontSize:"small"}),"data-link":"true"}),n&&e.jsx(R,{label:n,clickable:!1}),o&&e.jsx(R,{label:o,clickable:!1}),l&&e.jsx(R,{label:l,clickable:!1})]})}delete F.Icon.Default.prototype._getIconUrl;F.Icon.Default.mergeOptions({iconRetinaUrl:ae,iconUrl:se,shadowUrl:ie});function pe({station:n}){const o=E(),l=Z(o.breakpoints.down("sm"));if(!n)return null;const j=[Number(n.station_lat),Number(n.station_lon)],p=i=>{if(i==null)return"ไม่มีข้อมูล";const s=["ทิศเหนือ","ทิศตะวันออกเฉียงเหนือ","ทิศตะวันออก","ทิศตะวันออกเฉียงใต้","ทิศใต้","ทิศตะวันตกเฉียงใต้","ทิศตะวันตก","ทิศตะวันตกเฉียงเหนือ"],r=Math.round(i/45)%8;return s[r]};function y(i){if(!i)return"ไม่มีข้อมูลเวลา";const s=new Date(i);if(isNaN(s.getTime()))return"รูปแบบเวลาไม่ถูกต้อง";const r=s.getDate(),h=s.getMonth()+1,u=s.getFullYear()+543,v=String(s.getHours()).padStart(2,"0"),b=String(s.getMinutes()).padStart(2,"0"),S=String(s.getSeconds()).padStart(2,"0");return`ณ วันที่ ${r}/${h}/${u} เวลา ${v}:${b}:${S} น.`}const x=(i,s="")=>i==null||i===""?"-":`${i}${s}`,d={backgroundColor:"#eef1f8"};return e.jsx(D,{sx:{p:2,mb:2},children:e.jsxs(g,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",md:"row"}},children:[e.jsx(g,{sx:{flex:{xs:"unset",md:1},width:{xs:"100%",md:"auto"},height:{xs:250,md:190}},children:e.jsxs(le,{center:j,zoom:10,style:{height:"100%",width:"100%"},zoomControl:!1,scrollWheelZoom:!1,doubleClickZoom:!1,touchZoom:!1,boxZoom:!1,dragging:!1,minZoom:9,maxZoom:9,children:[e.jsx(oe,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(de,{position:j,interactive:!1,keyboard:!1})]})}),e.jsxs(g,{sx:{flex:1},children:[e.jsxs(g,{sx:{py:1,px:1},children:[e.jsxs(_,{fontWeight:600,children:["ข้อมูลตรวจวัดล่าสุดจาก ",n.station_name_th]}),e.jsx(_,{variant:"body2",color:"text.secondary",children:y(n.datetime_utc7)})]}),!l&&e.jsx(C,{children:e.jsx(T,{size:"small",children:e.jsxs(k,{children:[e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"จังหวัด"}),e.jsx(a,{children:n.province_name_th}),e.jsx(a,{sx:d,children:"ภูมิภาค"}),e.jsx(a,{children:n.region_name_th})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"อุณหภูมิ"}),e.jsx(a,{children:x(n.temperature," °C")}),e.jsx(a,{sx:d,children:"ความชื้น"}),e.jsx(a,{children:x(n.humidity," %")})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"ความกดอากาศ"}),e.jsx(a,{children:x(n.pressure," hPa")}),e.jsx(a,{sx:d,children:"ฝนสะสม 15 นาที"}),e.jsx(a,{children:x(n.precip_15mins," มม.")})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"ทิศทางลม"}),e.jsx(a,{children:p(n.winddirection)}),e.jsx(a,{sx:d,children:"ความเร็วลม"}),e.jsx(a,{children:x(n.windspeed," กม./ชม.")})]})]})})}),l&&e.jsx(C,{children:e.jsx(T,{size:"small",children:e.jsxs(k,{children:[e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"จังหวัด"}),e.jsx(a,{children:n.province_name_th})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"ภูมิภาค"}),e.jsx(a,{children:n.region_name_th})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"อุณหภูมิ"}),e.jsx(a,{children:x(n.temperature," °C")})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"ความชื้น"}),e.jsx(a,{children:x(n.humidity," %")})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"ความกดอากาศ"}),e.jsx(a,{children:x(n.pressure," hPa")})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"ฝนสะสม 15 นาที"}),e.jsx(a,{children:x(n.precip_15mins," มม.")})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"ทิศทางลม"}),e.jsx(a,{children:p(n.winddirection)})]}),e.jsxs(m,{hover:!0,children:[e.jsx(a,{sx:d,children:"ความเร็วลม"}),e.jsx(a,{children:x(n.windspeed," กม./ชม.")})]})]})})})]})]})})}const $=[{id:"date_utc7",label:"วันที่",align:"center",noUnit:!0,render:n=>new Date(n.date_utc7).toLocaleDateString("th-TH")},{id:"temperature_min_today",label:"อุณหภูมิต่ำสุด",unit:"°C",align:"center"},{id:"temperature_max_today",label:"อุณหภูมิสูงสุด",unit:"°C",align:"center"},{id:"precip_today",label:"ปริมาณฝนสะสมรายวัน",unit:"มม.",align:"center"}];function ge({dailyRows:n,nowAll:o}){const l=E(),j=Z(l.breakpoints.down("sm")),[p,y]=f.useState(0),x=4,[d,i]=f.useState("temp"),[s,r]=f.useState("max"),h=n||[],u=f.useMemo(()=>o!=null&&o.length?o.filter(t=>s==="max"?t.temperature_max_today!=null:t.temperature_min_today!=null).sort((t,c)=>s==="max"?c.temperature_max_today-t.temperature_max_today:t.temperature_min_today-c.temperature_min_today).map((t,c)=>({rank:c+1,stationId:t.station_id,station:t.station_name_th,province:t.province_name_th,value:s==="max"?t.temperature_max_today:t.temperature_min_today,unit:"°C"})):[],[o,s]),v=f.useMemo(()=>o!=null&&o.length?o.filter(t=>t.precip_today!=null).sort((t,c)=>s==="max"?c.precip_today-t.precip_today:t.precip_today-c.precip_today).map((t,c)=>({rank:c+1,stationId:t.station_id,station:t.station_name_th,province:t.province_name_th,value:t.precip_today,unit:"มม."})):[],[o,s]),b=d==="temp"?u:v,S=f.useMemo(()=>{const t=p*x;return b.slice(t,t+x)},[b,p]);return h.length?e.jsxs(g,{sx:{display:"flex",gap:2,mb:2,flexDirection:{xs:"column",md:"row"}},children:[e.jsxs(D,{sx:{flex:2.5,px:2},children:[e.jsx(_,{sx:{py:2.5},fontWeight:600,children:"สรุปลักษณะอากาศประจำวัน"}),e.jsx(C,{children:e.jsxs(T,{size:"small",sx:{mb:3,borderCollapse:"separate","& th, & td":{border:"1px solid rgba(224,224,224,1)"}},children:[e.jsxs(I,{sx:{backgroundColor:"#eef1f8","& .MuiTableCell-root":{fontWeight:600,border:"1px solid rgba(224,224,224,1)"}},children:[e.jsx(m,{children:$.map(t=>t.noUnit?e.jsx(a,{align:t.align,rowSpan:2,sx:{fontWeight:600,verticalAlign:"middle"},children:t.label},t.id):e.jsx(a,{align:t.align,sx:{fontWeight:600},children:t.label},t.id))}),e.jsx(m,{children:$.filter(t=>!t.noUnit).map(t=>e.jsx(a,{align:t.align,sx:{fontSize:12,color:"text.secondary",pt:0},children:t.unit},t.id))})]}),e.jsx(k,{children:h.map(t=>e.jsx(m,{hover:!0,children:$.map(c=>e.jsx(a,{align:c.align,children:c.render?c.render(t):t[c.id]??"-"},c.id))},t.date_utc7))})]})})]}),e.jsxs(D,{sx:{flex:2.5,px:2},children:[e.jsxs(g,{sx:{pt:1.5,display:"flex",alignItems:"center",gap:1,flexDirection:{xs:"column",sm:"row"}},children:[e.jsx(_,{fontWeight:600,sx:{flexShrink:0,whiteSpace:"nowrap",width:{xs:"100%",sm:"auto"},textAlign:"left"},children:"ตารางอันดับข้อมูลรายวัน"}),e.jsxs(G,{value:d,onChange:(t,c)=>{i(c),y(0)},variant:j?"fullWidth":"standard",sx:{width:{xs:"100%",sm:"auto"},ml:{xs:0,sm:"auto"},backgroundColor:"#f1f3f6",borderRadius:1.5,minHeight:40,"& .MuiTabs-indicator":{height:3,borderRadius:2,background:"linear-gradient(135deg, #1e293b, #0f172a)"}},children:[e.jsx(H,{value:"temp",label:"อุณหภูมิ",sx:{textTransform:"none",fontWeight:500,color:"text.secondary",minWidth:{xs:0,sm:90},flex:{xs:1,sm:"none"},"&.Mui-selected":{color:"#0f172a",fontWeight:600}}}),e.jsx(H,{value:"rain",label:"ฝน",sx:{textTransform:"none",fontWeight:500,color:"text.secondary",minWidth:{xs:0,sm:90},flex:{xs:1,sm:"none"},"&.Mui-selected":{color:"#0f172a",fontWeight:600}}})]})]}),e.jsx(g,{sx:{px:2},children:e.jsxs(Q,{row:!0,value:s,onChange:t=>{r(t.target.value),y(0)},children:[e.jsx(W,{value:"max",control:e.jsx(M,{size:"small"}),label:"ค่าสูงสุด"}),e.jsx(W,{value:"min",control:e.jsx(M,{size:"small"}),label:"ค่าต่ำสุด"})]})}),e.jsx(C,{children:e.jsxs(T,{size:"small",children:[e.jsx(I,{sx:{backgroundColor:"#eef1f8","& .MuiTableCell-root":{fontWeight:600,border:"1px solid rgba(224,224,224,1)"}},children:e.jsxs(m,{children:[e.jsx(a,{align:"center",children:"อันดับ"}),e.jsx(a,{children:"สถานี"}),e.jsx(a,{children:"จังหวัด"}),e.jsx(a,{align:"center",children:d==="temp"?"°C":"มม."})]})}),e.jsx(k,{children:S.length?S.map(t=>e.jsxs(m,{hover:!0,children:[e.jsx(a,{align:"center",children:t.rank}),e.jsx(a,{children:e.jsx(B,{to:`/awsmap/stations/${t.stationId}`,target:"_blank",style:{color:"inherit",textDecoration:"none"},children:t.station})}),e.jsx(a,{children:t.province||"-"}),e.jsx(a,{align:"center",children:t.value})]},t.rank)):e.jsx(m,{children:e.jsx(a,{colSpan:4,align:"center",children:"ไม่มีข้อมูล"})})})]})}),e.jsx(Y,{component:"div",count:b.length,page:p,onPageChange:(t,c)=>y(c),rowsPerPage:x,rowsPerPageOptions:[x],labelRowsPerPage:"",labelDisplayedRows:({from:t,to:c,count:P})=>`${t}-${c} จาก ${P}`})]})]}):null}function je({rows:n,stationName:o}){const[l,j]=O.useState(0),[p,y]=O.useState(25),x=[{id:"datetime_utc7",label:"วันที่/เวลา",align:"center",noUnit:!0,render:r=>r.datetime_utc7?new Date(r.datetime_utc7).toLocaleString("th-TH"):"-"},{id:"temperature",label:"อุณหภูมิ",unit:"°C",align:"center"},{id:"precip_1hr",label:"ฝนสะสม 1 ชม.",unit:"มม.",align:"center"},{id:"winddirection",label:"ทิศทางลม",unit:"8 ทิศทาง",align:"center",render:r=>d(r.winddirection)},{id:"windspeed",label:"ความเร็วลม",unit:"กม./ชม.",align:"center"},{id:"humidity",label:"ความชื้น",unit:"%",align:"center"},{id:"pressure",label:"ความกดอากาศ",unit:"hPa",align:"center"}],d=r=>{if(r==null)return"ไม่มีข้อมูล";const h=["ทิศเหนือ","ทิศตะวันออกเฉียงเหนือ","ทิศตะวันออก","ทิศตะวันออกเฉียงใต้","ทิศใต้","ทิศตะวันตกเฉียงใต้","ทิศตะวันตก","ทิศตะวันตกเฉียงเหนือ"],u=Math.round(r/45)%8;return h[u]},i=(r,h)=>{j(h)},s=r=>{y(parseInt(r.target.value,10)),j(0)};return e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"h5",sx:{mb:1},children:["ข้อมูลสภาพอากาศ AWS ย้อนหลัง 48 ชั่วโมง ",o]}),e.jsx(C,{sx:{maxHeight:461},children:e.jsxs(T,{size:"small",sx:{borderCollapse:"separate","& th, & td":{border:"1px solid rgba(224,224,224,1)"}},children:[e.jsxs(I,{sx:{backgroundColor:"#eef1f8","& .MuiTableCell-root":{fontWeight:600,border:"1px solid rgba(224,224,224,1)"}},children:[e.jsx(m,{children:x.map(r=>r.noUnit?e.jsx(a,{align:r.align,rowSpan:2,sx:{verticalAlign:"middle"},children:r.label},r.id):e.jsx(a,{align:r.align,children:r.label},r.id))}),e.jsx(m,{children:x.filter(r=>!r.noUnit).map(r=>e.jsx(a,{align:r.align,sx:{fontSize:12,color:"text.secondary",pt:0,backgroundColor:"#eef1f8"},children:r.unit},r.id))})]}),e.jsx(k,{children:n.length===0?e.jsx(m,{children:e.jsx(a,{colSpan:x.length,align:"center",sx:{color:"text.secondary"},children:"ไม่มีข้อมูล"})}):n.slice(l*p,l*p+p).map((r,h)=>e.jsx(m,{hover:!0,children:x.map(u=>e.jsx(a,{align:u.align,children:u.render?u.render(r):r[u.id]??"-"},u.id))},h))})]})}),e.jsx(Y,{rowsPerPageOptions:[10,25,50,100],component:"div",count:n.length,rowsPerPage:p,page:l,onPageChange:i,onRowsPerPageChange:s,labelRowsPerPage:"แสดงต่อหน้า"})]})}q.setOptions({time:{useUTC:!1}});function fe({rows:n,stationName:o}){const[l,j]=f.useState("rain"),p=i=>{const s=new Set;return i.filter(r=>r.datetime_utc7).map(r=>{const h=new Date(r.datetime_utc7);return h.setHours(0,0,0,0),h.getTime()}).filter(r=>s.has(r)?!1:(s.add(r),!0)).map(r=>({value:r,color:"#9e9e9e",width:1,dashStyle:"Dash",zIndex:5}))},y=(i,s)=>{const r={};return i.forEach(h=>{if(!h.datetime_utc7)return;const u=new Date(h.datetime_utc7);u.setMinutes(0,0,0);const v=u.getTime();let b=h[s];if(s==="temperature"&&(b===null||b===0)){r[v]=null;return}r[v]=Number(b)}),Object.entries(r).map(([h,u])=>[Number(h),u]).sort((h,u)=>h[0]-u[0])},x=l==="rain"?[{name:"ฝนรายชั่วโมง (มม.)",type:"column",data:y(n,"precip_1hr"),color:"#1e88e5",dataLabels:{enabled:!0,formatter(){return this.y}}}]:[{name:"อุณหภูมิ (°C)",type:"line",data:y(n,"temperature"),color:"#ef6c00",marker:{enabled:!0,radius:4},dataLabels:{enabled:!0,formatter(){return this.y===null?null:this.y}},connectNulls:!1}],d={accessibility:{enabled:!1},chart:{height:460},title:{text:l==="rain"?"ปริมาณฝนรายชั่วโมงย้อนหลัง":"อุณหภูมิรายชั่วโมงย้อนหลัง"},rangeSelector:{enabled:!1},navigator:{enabled:!0},scrollbar:{enabled:!0},xAxis:{type:"datetime",tickInterval:3600*1e3,plotLines:p(n),labels:{formatter(){const i=new Date(this.value),s=i.getHours(),r=i.getMinutes();return s===0&&r===0?i.toLocaleDateString("th-TH",{day:"numeric",month:"short"})+" 00:00":i.toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})}}},yAxis:{title:{text:l==="rain"?"มิลลิเมตร":"องศาเซลเซียส"}},tooltip:{formatter(){return`
                    <b>${new Date(this.x).toLocaleString("th-TH")}</b><br/>
                    ${this.series.name}: <b>${this.y}</b>
                `}},plotOptions:{series:{dataGrouping:{enabled:!1}}},series:x};return e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"h5",sx:{mb:1},children:["กราฟสภาพอากาศ AWS ย้อนหลัง 48 ชั่วโมง ",o]}),e.jsxs(Q,{row:!0,value:l,onChange:i=>j(i.target.value),sx:{mb:2},children:[e.jsx(W,{value:"rain",control:e.jsx(M,{size:"small"}),label:"ฝน"}),e.jsx(W,{value:"temp",control:e.jsx(M,{size:"small"}),label:"อุณหภูมิ"})]}),e.jsx(ce,{highcharts:q,constructorType:"stockChart",options:d})]})}function be({children:n,value:o,index:l}){return e.jsx("div",{role:"tabpanel",hidden:o!==l,id:`tabpanel-${l}`,"aria-labelledby":`tab-${l}`,children:o===l&&e.jsx(g,{sx:{p:2},children:n})})}function ye({tab:n,onChange:o,tabs:l}){return e.jsxs(e.Fragment,{children:[e.jsx(g,{sx:{width:"100%",display:"flex",justifyContent:"flex-end"},children:e.jsx(g,{sx:{width:"fit-content",backgroundColor:"#f1f3f6",border:"1px solid #e0e0e0",borderBottom:"none",borderRadius:"8px 8px 0 0"},children:e.jsx(G,{value:n,onChange:o,sx:{minHeight:40,"& .MuiTabs-indicator":{height:3,borderRadius:2,background:"linear-gradient(135deg, #1e293b, #0f172a)"}},children:l.map((j,p)=>e.jsx(H,{label:j.label,sx:{textTransform:"none",minHeight:40,px:2,fontWeight:500,color:"text.secondary","&.Mui-selected":{color:"#0f172a",fontWeight:600}}},p))})})}),e.jsx(D,{sx:{boxShadow:1,border:"1px solid #e0e0e0",borderRadius:2,borderTopRightRadius:0},children:l.map((j,p)=>e.jsx(be,{value:n,index:p,children:j.content},p))})]})}function _e(){const n=new Date().getFullYear();return e.jsx(g,{component:"footer",sx:{mt:4,py:2,bgcolor:"#eef1f4",borderTop:"1px solid #e0e0e0"},children:e.jsx(V,{maxWidth:"lg",children:e.jsxs(_,{variant:"body2",color:"text.secondary",align:"center",children:["© ",n+543," พัฒนาโดยศูนย์เทคโนโลยีสารสนเทศ กองบริการดิจิทัลอุตุนิยมวิทยา"]})})})}function Se(){const{id:n}=xe(),[o,l]=f.useState([]),[j,p]=f.useState(0),[y,x]=f.useState(!0),[d,i]=f.useState(null),[s,r]=f.useState(null),[h,u]=f.useState([]),[v,b]=f.useState([]);f.useEffect(()=>{if(!n)return;(async()=>{var c,P,L;try{x(!0),i(null);const[w,N,U]=await Promise.all([z.get("https://wxmap.tmd.go.th/api/awsnow"),z.get("https://wxmap.tmd.go.th/api/awsnowbyid",{params:{id:n}}),z.get("https://wxmap.tmd.go.th/api/awsdailybyid",{params:{id:n}})]);if((c=w.data)!=null&&c.success&&Array.isArray(w.data.data)){u(w.data.data);const A=w.data.data.find(J=>String(J.station_id)===String(n));r(A||null)}else u([]),r(null);(P=N.data)!=null&&P.success?l(N.data.data||[]):l([]),(L=U.data)!=null&&L.success?b(U.data.data||[]):b([])}catch(w){console.error(w),r(null),l([]),u([]),b([]),i("เกิดข้อผิดพลาดในการเชื่อมต่อ API")}finally{x(!1)}})()},[n]);const S=(s==null?void 0:s.station_name_th)??"";return y?e.jsxs(g,{sx:{position:"fixed",inset:0,zIndex:9999,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"rgba(255,255,255,0.9)"},children:[e.jsx(he,{size:48}),e.jsx(_,{sx:{mt:1},variant:"body2",color:"text.secondary",children:"กำลังโหลดข้อมูลสถานี..."})]}):d?e.jsx(g,{sx:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(ue,{sx:{fontSize:40,color:"error.main"}}),e.jsx(_,{children:d})]})}):e.jsxs(g,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",bgcolor:"#f3f5f6"},children:[e.jsx(g,{sx:{flex:1},children:e.jsxs(V,{maxWidth:"lg",sx:{py:3},children:[s&&e.jsx(me,{region:s.region_name_th,province:s.province_name_th,station:s.station_name_th}),e.jsx(pe,{station:s}),e.jsx(ge,{dailyRows:v,nowAll:h}),e.jsx(ye,{tab:j,onChange:(t,c)=>p(c),tabs:[{label:"ตาราง",content:e.jsx(je,{rows:o,stationName:S})},{label:"กราฟ",content:e.jsx(fe,{rows:o,stationName:S})}]})]})}),e.jsx(_e,{})]})}export{Se as default};
